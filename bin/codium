#!/usr/bin/dash

PREFERRED='code-oss' # or codium
PREFERRED='codium'

flatpak_path='/var/lib/flatpak/exports/bin/com.vscodium.codium'

codium_paths="$(
    IFS=':'
    for i in $PATH; do
        i_path="$i/$PREFERRED"
        [ "$i_path" = "$0" ] && continue
        if [ -x "$i_path" ]; then
            echo "$i_path"
            break
        fi
    done
)"

# codium wayland finally shows my cursor :D
[ -n "${WAYLAND_DISPLAY:-}" ] && ozonewayland='--ozone-platform=wayland'
#  --enable-features=UseOzonePlatform
if [ -n "${codium_paths:-}" ]; then
    exec $codium_paths ${ozonewayland} "$@"
elif [ -f "$flatpak_path" ]; then
    exec flatpak run com.vscodium.codium ${ozonewayland} "$@"
else
    notify-send -a "${0##*/}" 'Error' "Could not find VSCodium installation"
fi
