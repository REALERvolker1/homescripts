#!/usr/bin/dash

flatpak_path='/var/lib/flatpak/exports/bin/com.vscodium.codium'

# change order to change preference
editors='code:codium'

if [ -x "${VLK_VSC:-null}" ]; then
    codium_path="${VLK_VSC:-null}"
else
    codium_path="$(
        IFS=':'
        for i in $PATH; do
            for j in $editors; do
                i_path="$i/$j"
                [ "$i_path" = "$0" ] && continue
                if [ -x "$i_path" ]; then
                    echo "$i_path"
                    break
                fi
            done
        done
    )"
fi

[ -n "${WAYLAND_DISPLAY:-}" ] && ozonewayland='--enable-features=UseOzonePlatform --ozone-platform=wayland '
if [ -n "${codium_path:-}" ]; then
    echo "Launching $codium_path"
    exec $codium_path ${ozonewayland}"$@"
elif [ -f "$flatpak_path" ]; then
    exec flatpak run com.vscodium.codium ${ozonewayland}"$@"
else
    notify-send -a "${0##*/}" 'Error' "Could not find VSCodium installation"
fi
