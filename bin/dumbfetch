#!/usr/bin/dash
box_color="[38;5;$(shuf -i 1-255 -n 1)m"

prop0="${SHLVL:-999}"
prop1="$(uptime -p | sed 's/^up // ; s/hour/hr/g ; s/minute/min/g')"
prop2="${TERM:-Undefined}"
prop3="$(printf '%s\t' $(df -h -l -t btrfs --output=pcent) | cut -f 2)"
if [ -n "${CONTAINER_ID:-}" ]; then
    prop4="${CONTAINER_ID:-}"
    prop4_label='ó°– Distbx'
else
    prop4="$(
        if command -v 'rpm' >/dev/null 2>&1; then
            rpm -q xorg-x11-drv-nvidia | cut -d '-' -f 5
        elif command -v 'pacman' >/dev/null 2>&1; then
            pacman -Q nvidia-dkms 2>/dev/null | grep -oP '^.* \K[^-]*'
        elif command -v 'apt' >/dev/null 2>&1; then
            apt list 2>/dev/null | grep -m 1 nvidia-driver | cut -d ' ' -f 2
        else
            echo 'unsupported distro'
        fi
    )"
    prop4_label='ó°¾² Nvidia'
fi
prop5="$(uname -r | grep -o '^[^-]*-[^.]*')"

len=0
for i in "$prop1" "$prop2" "$prop4" "$prop5"; do
    [ "${#i}" -gt "$len" ] && len="${#i}"
done
length_string="$(printf "%-${len}s\n" '' | sed 's/ /â”€/g')"

printf '%s\n' "${box_color}â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€${length_string}â•®[0m"
printf "${box_color}â”‚[0m[92m%s${box_color}â”‚[0m%s   [1m%-${len}s [0m${box_color}â”‚[0m\n" \
    '          _      ' '[94m î¯Š SHLVL ' "$prop0" \
    '  _______| |__   ' '[95m ó°… Uptime' "$prop1" \
    ' |_  / __| `_ \  ' '[96m ï’‰ Term  ' "$prop2" \
    '  / /\__ \ | | | ' '[93m ó°‹Š Disk  ' "$prop3" \
    ' /___|___/_| |_| ' "[92m $prop4_label" "$prop4" \
    '                 ' '[91m î¯† Kernel' "$prop5"
printf '%s\n' "${box_color}â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€${length_string}â•¯[0m"
# â”´
